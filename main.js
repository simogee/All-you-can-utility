(()=>{"use strict";const e=document.querySelector("body"),t=document.querySelector("#pag"),n=document.querySelector("#dialog-template"),r=document.querySelector("#order-card");function o(e,t,n){if(t.replaceChildren(),n){const e=document.createElement("h2");e.innerText=n,t.appendChild(e)}e.forEach(e=>{const n=r.content.cloneNode(!0),o=n.querySelector(".nome-piatto"),u=n.querySelector(".numero-piatto"),c=n.querySelector(".quantitÃ ");n.querySelector(".add"),n.querySelector(".del"),n.querySelector(".remove"),o.textContent=e.name,u.textContent=e.number,c.textContent=e.quantity,t.appendChild(n)})}let u=[],c=[];function i(e,t){const n=function(e,t){return{name:e,number:t,quantity:1}}(e,t),r=u.find(e=>e.number===n.number);void 0===r?u.push(n):r.quantity++}function d(){return u.slice().reduce((e,t)=>{const n=e.find(e=>e.number===t.number);return n?n.quantity+=t.quantity:e.push({...t}),e},[])}const a=function(){const n=document.importNode(t.content,!0),r={header:n.querySelector("#hdr"),specialBtn:n.querySelector("#eheh"),aside:n.querySelector("#left-part"),main:n.querySelector("main"),ordBtn:n.querySelector("#ord-btn"),oldOrdBtn:n.querySelector("#old-ord-btn"),ordersContainer:n.querySelector("#orders-container"),addBtn:n.querySelector("#add"),sortBtn:n.querySelector("#sort")};return e.appendChild(n),r}();!function(){for(let e=0;e<10;e++)i("prova",123),i("gigi",222)}();const l=function(e){const t=n.content.cloneNode(!0),r=t.querySelector("dialog"),o=t.querySelector("form"),u=t.querySelector("#nomepiatto"),c=t.querySelector("#numeropiatto"),i=t.querySelector('input[type="submit"]'),d=t.querySelector('input[type="button"]');return e.appendChild(t),{dialog:r,form:o,nomeInput:u,numeroInput:c,submitBtn:i,cancelBtn:d}}(document.querySelector("body"));a.ordersContainer.addEventListener("click",e=>{const t=e.target.closest(".card");if(!t)return;const n=Number(t.querySelector(".numero-piatto").textContent),r=t.querySelector(".nome-piatto").textContent;if(e.target.closest(".add"))i(r,Number(n));else if(e.target.closest(".remove"))!function(e){const t=u.findIndex(t=>t.number==e);-1!==t&&(u[t].quantity<=1?(u[t].quantity=0,c.push(u[t]),u.splice(t,1)):u[t].quantity>1?u[t].quantity--:u[t].quantity=1)}(Number(n));else{if(!e.target.closest(".del"))return;!function(e){const t=u.findIndex(t=>t.number==e);-1!=t&&u.splice(t,1)}(Number(n))}o(d(),a.ordersContainer,"Ordini")}),a.ordBtn.addEventListener("click",()=>{o(d(),a.ordersContainer,"Ordini")}),a.oldOrdBtn.addEventListener("click",()=>{o(c.slice().reduce((e,t)=>{const n=e.find(e=>e.number===t.number);return n?n.quantity+=t.quantity:e.push({...t}),e},[]),a.ordersContainer,"Vecchi Ordini")}),a.addBtn.addEventListener("click",()=>{l.dialog.showModal()}),l.cancelBtn.addEventListener("click",e=>{l.form.reset(),l.dialog.close()}),l.form.addEventListener("submit",e=>{const t=new FormData(l.form);i(t.get("nomepiatto"),Number(t.get("numeropiatto"))),o(d(),a.ordersContainer),e.preventDefault(),l.form.reset(),l.dialog.close()}),a.sortBtn.addEventListener("click",e=>{u.sort(function(e,t){return e.number<t.number?-1:e.number>t.number?1:0}),o(d(),a.ordersContainer)})})();